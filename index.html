<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Digital Study Library</title>
  <link rel="stylesheet" href="style.css">
  <style>
    body { margin:0; font-family:Poppins, sans-serif; background:#f1f5ff; }
    header { text-align:center; padding:25px; background:#2979ff; color:white; font-size:20px; font-weight:bold; box-shadow:0 0 15px rgba(0,0,0,0.2); }
    nav { background:#d7e9ff; padding:15px; display:flex; justify-content:center; gap:15px; }
    nav button { padding:10px 20px; background:#2979ff; color:white; border:none; border-radius:6px; font-size:15px; cursor:pointer; transition:.3s; }
    nav button:hover{ transform:scale(1.05); background:#005ace; }
    .page{ padding:30px; text-align:center; }
    .book-grid{ display:grid; grid-template-columns:repeat(auto-fit,minmax(160px,1fr)); gap:20px; margin-top:25px; }
    .book{ background:white; border-radius:10px; padding:12px; cursor:pointer; box-shadow:0 4px 12px rgba(0,0,0,0.1); transition:.3s; }
    .book:hover{ transform:scale(1.05); }
    .book img{ width:100%; height:220px; border-radius:8px; object-fit:cover; }
    .book-link { display:inline-block; margin-top:8px; padding:6px 12px; background:#3498db; color:white; text-decoration:none; border-radius:5px; font-size:13px; transition:.3s; }
    .book-link:hover { background:#217dbb; }
    .upload-box{ background:white; padding:20px; width:300px; margin:auto; border-radius:8px; box-shadow:0 4px 10px rgba(0,0,0,0.1); }
    .upload-box input{ width:100%; margin-bottom:10px; }
    .upload-box button{ width:100%; padding:10px; background:#28b463; color:white; border:none; cursor:pointer; border-radius:6px; }
    .upload-box button:hover{ background:#1e7d46; }
    ul li{ background:white; margin:10px auto; padding:10px; width:300px; border-left:5px solid #2979ff; border-radius:5px; }
    .popup{ display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:#000000c0; justify-content:center; align-items:center; flex-direction:column; z-index:999; }
    .popup-header{ width:80%; display:flex; justify-content:space-between; background:#fff; padding:10px; border-radius:6px 6px 0 0; }
    .popup-header button{ background:#e74c3c; color:white; border:none; padding:8px 14px; border-radius:5px; cursor:pointer; }
    .popup-header a{ background:#3498db; color:white; text-decoration:none; padding:8px 14px; border-radius:5px; }
    iframe{ width:80%; height:80%; border:none; background:white; border-radius:0 0 6px 6px; }
  </style>
</head>
<body>

<header>
  <h1>üìö Digital Study Library</h1>
  <p>25 School Books ¬∑ Click to Read Instantly</p>
</header>

<nav>
  <button onclick="openSection('library')">üìò Books</button>
  <button onclick="openSection('notes')">üìù Notes</button>
</nav>

<!-- ================= LIBRARY =================== -->
<section id="library" class="page">
  <h2>Bookshelf</h2>
  <p>Click a book to open the PDF reader or click at the link button</p>
  <p>Some of the books are Ebooks, so click on the pdf to get access to the Username/password, then click on the link (#) </p>
  <div id="bookGrid" class="book-grid"></div>
</section>

<!-- ================= NOTES =================== -->
<section id="notes" class="page" style="display:none;">
  <h2>üìù Upload Your Notes</h2>
  <p>Share useful revision notes with your classmates.</p>
  <div class="upload-box">
    <input type="file" id="fileInput" accept="application/pdf">
    <button onclick="uploadNote()">Upload</button>
  </div>
  <h3>üìÑ Shared Notes</h3>
  <ul id="noteList"></ul>
</section>

<!-- ================= PDF VIEWER POPUP =================== -->
<div id="pdfPopup" class="popup">
  <div class="popup-header">
    <button onclick="closePDF()">‚¨Ö Back</button>
    <a id="pdfDownload" download>Download PDF</a>
  </div>
  <iframe id="pdfFrame"></iframe>
</div>

<!-- ================= Firebase Auth + Book Script =================== -->
<script type="module">
  // ------------------ Firebase Init ------------------
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";
  import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-auth.js";

  const firebaseConfig = {
    apiKey: "AIzaSyDO7VsuqCgnWN4vlFXNjExZZTbR4j0dVLw",
    authDomain: "digitallibrary-7018d.firebaseapp.com",
    projectId: "digitallibrary-7018d",
    storageBucket: "digitallibrary-7018d.firebasestorage.app",
    messagingSenderId: "64527292424",
    appId: "1:64527292424:web:9f8a23b1c05bd55d59d9bd"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);

  // ------------------ Auth Check ------------------
  onAuthStateChanged(auth, (user) => {
    if (!user) window.location.href = "login.html"; // redirect if not logged in
  });

  // ------------------ Logout Button ------------------
  const logoutBtn = document.createElement("button");
  logoutBtn.textContent = "Logout";
  logoutBtn.style.position = "fixed";
  logoutBtn.style.top = "10px";
  logoutBtn.style.right = "10px";
  logoutBtn.onclick = () => signOut(auth).then(() => window.location.href="login.html");
  document.body.appendChild(logoutBtn);

  // ------------------ Book & Notes Script ------------------
  const books = [
    {title:"Text & Test 3", img:"books/book1.jpg",link:"https://my.cjfallon.ie/preview/student/10873/459"},
    { title:"Text & Test 4", img:"books/book2.jpg", pdf:"pdfs/book2.pdf" },
    { title:"Biology", img:"books/book4.jpg", pdf:"pdfs/book7.pdf", link:"https://edcolearning.ie/Book/List" },
    // Add all your other books here
  ];

  const grid = document.getElementById("bookGrid");

  books.forEach(b=>{
    let card = document.createElement("div");
    card.className = "book";
    card.innerHTML = `
      <img src="${b.img}">
      <p>${b.title}</p>
      ${b.link ? `<a href="${b.link}" target="_blank" class="book-link">Open Link</a>` : ''}
    `;
    card.onclick = () => openPDF(b.pdf);
    grid.appendChild(card);
  });

  function openPDF(file){
    if(!file) return;
    document.getElementById("pdfPopup").style.display="flex";
    document.getElementById("pdfFrame").src=file;
    document.getElementById("pdfDownload").href=file;
  }

  function closePDF(){ document.getElementById("pdfPopup").style.display="none"; }

  function uploadNote(){
    let file=document.getElementById("fileInput").files[0];
    if(!file) return alert("Please select a PDF");
    let li=document.createElement("li");
    li.textContent=file.name;
    document.getElementById("noteList").appendChild(li);
  }

  function openSection(id){
    document.querySelectorAll(".page").forEach(p=>p.style.display="none");
    document.getElementById(id).style.display="block";
  }
</script>

</body>
</html>
